pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
-- extraction
-- my time at the dentist
current_scene = -2
final_scene = 1000
first_run = true

-- continue current scene
--  x times over
continue_scene = 0

scene_updated_this_pattern = false
scene_just_entered = false

show_debug = false

-- time vars
_demotime_start = 0
_scenetime_start = 0



function printwithbg(tt, tx, ty, bg, fg)
 	print(tt, tx-1, ty-1, bg)
 	print(tt, tx+1, ty-1, bg)
 	print(tt, tx-1, ty, bg)
 	print(tt, tx+1, ty, bg)
 	print(tt, tx, ty-1, bg)
 	print(tt, tx, ty+1, bg)
 	print(tt, tx-1, ty+1, bg)
 	print(tt, tx+1, ty+1, bg)
 	print(tt, tx, ty, fg)
end


-- default demo stuff
function tan(a)
		return sin(a)/cos(a)
end

function demotime()
		return time() - _demotime_start
end

function scenetime()
		return time() - _scenetime_start
end

scene_just_entered = true

function _init()
		music(0)
end

function _update()
		-- update music scene count
		if stat(20) < 5 then
				if not scene_updated_this_pattern then
						scene_updated_this_pattern = true
						
						if 0 < continue_scene then
								continue_scene -= 1
						else
  						scene_just_entered = true
  						current_scene += 1
  						if final_scene < current_scene then
  								current_scene = 0
  								continue_scene = 0 -- prevent overflows
  								_demotime_start = time()
  								first_run = false
  						end
  						_scenetime_start = time()
 					end
				end
		else
				scene_updated_this_pattern = false
		end
		
		-- show debug
		if btnp(4) then
				show_debug = not show_debug
		end
end

function _draw()
		-- setup
		local dt = demotime()
		local st = scenetime()

		-- drawing
		-- sc is used to simplify adding
		--  new scenes in the middle and
		--  shuffling them around
		sc = -1
		if current_scene == sc then
				-- do nothing
		end
		
		sc += 1
		if current_scene == sc then
				if scene_just_entered then
						continue_scene = 1
				end
				cls(6)
				sspr(16,0,16,16, 0,0,128,128)
				
				tx = 11 + sin(st*0.5)*4.9
				ty = 115 + cos(st*0.35)*4.9
				tt = "this might hurt just a bit~"
				printwithbg(tt, tx, ty, 13, 14)
				
				print("♥", 70 + sin(st*0.3)*4.9, 15 + cos(st*0.3)*4.9, 8)
				print("♥", 65 + sin(st*0.3)*4.9, 22 + cos(st*0.3)*4.9, 8)
				
				if first_run then
						print("extraction", 4, 2, 5)
						--print("extraction", 4, 47+sin(st*0.5)*4.9, 5)
						--print("ft. dentist", 4, 54+sin(st*0.5)*4.9, 2)
				end
		end
		
		sc += 1
		if current_scene == sc then
				cls(0)

				print("*drilling*", 50-st*4.6, 15, 5)
				print("*bzzzz*", 90-st*17.3, 35, 5)
				print("*crackle*", 84-st*12.3, 60, 5)

				-- make the randomness less random
				srand(flr(st*7)*0.1)
				ofx = rnd()*3.9
				ofy = rnd()*2.9
				sspr(32,0,16,16, 0-ofx,0-ofy,128+ofx,128+ofy)
				
				tx = 11 + sin(st*0.5)*4.9
				ty = 115 + cos(st*0.35)*4.9
				tt = "there we go, just a minute~"
				printwithbg(tt, tx, ty, 13, 14)
				
				print("♥", 70 + sin(st*0.3)*4.9, 15 + cos(st*0.3)*4.9, 8)
				print("♥", 65 + sin(st*0.3)*4.9, 22 + cos(st*0.3)*4.9, 8)
		end		
		
		-- set final scene count
		final_scene = sc
		
		-- print debug info
		if show_debug then
  		-- print scene time lol
  		color(1)
  		rectfill(103, 0, 128, 12)
  		rectfill(0, 0, 40, 18)
  		
  		color(14)
  		print(current_scene, 104, 1)
  		print(st, 104, 1+6)

  		color(7)
  		print("cpu:" .. stat(1), 1, 1)
  		print("    " .. stat(2), 1, 1+6)
  		print("fps:" .. stat(7) .. "/" .. stat(8), 1, 1+6+6)
  end
		
		-- remove scene_just_entered
		if scene_just_entered then
				scene_just_entered = false
		end
end

__gfx__
00000000000000007777666666667777600001110001666666661111111166660000000000000000000000000000000000000000000000000000000000000000
00000000000000007776666776665657000001160001010666611116611101060000000000000000000000000000000000000000000000000000000000000000
00700700000000007766667777655555061000060000000066111166661000000000000000000000000000000000000000000000000000000000000000000000
00077000000000007766666666655555061000010100000066111111111000000000000000000000000000000000000000000000000000000000000000000000
00077000000000006666776776555555101110010100000011111111110000000000000000000000000000000000000000000000000000000000000000000000
00700700000000006666777776555555110110018100000011111111810000000000000000000000000000000000000000000000000000000000000000000000
00000000000000006666677766655555110100018110000011111111811000000000000000000000000000000000000000000000000000000000000000000000
00000000000000006666677765667555111100118011200011111111801120000000000000000000000000000000000000000000000000000000000000000000
00000000000000006666776755665575111110100011002011111110001100200000000000000000000000000000000000000000000000000000000000000000
00000000000000005566766655565575331101110001002033111111000100200000000000000000000000000000000000000000000000000000000000000000
00000000000000005776666666555575366111110100002036611111110000200000000000000000000000000000000000000000000000000000000000000000
00000000000000005577666666665555336611111011000033661111111100000000000000000000000000000000000000000000000000000000000000000000
00000000000000007776666666665555666011110011000066611111111100000000000000000000000000000000000000000000000000000000000000000000
00000000000000007dddd66666ddd555620221110122200062222111112220000000000000000000000000000000000000000000000000000000000000000000
00000000000000007dddddddddddddd5622022222022222062222222222222200000000000000000000000000000000000000000000000000000000000000000
0000000000000000dddddddddddddddd222222222222222222222222222222220000000000000000000000000000000000000000000000000000000000000000
__label__
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777777777777666666666666666666666666666666666666666666666666666666666666666677777777777777777777777777777777
77777777777777777777777766666666666666666666666666666666777777777777777766666666666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766666666666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766666666666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766666666666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766886886666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766888886666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766888886666666666666666655555555666666665555555577777777
77777777777777777777777766666666666666666666666666666666777777777777777766688866666666666666666655555555666666665555555577777777
77777777777777776666666666666666666666666666666677777777777777777777777777778777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777777777777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777777777777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777788788777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777788888777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777788888777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777778887777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666677777777777777777777777877777777666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
77777777777777776666666666666666666666666666666666666666666666666666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666777777777777777777777777777777777777777766666666555555555555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666666666666666666665555555555555555555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666666666667777777777777777777777776666666655555555666666666666666677777777555555555555555555555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
66666666666666666666666666666666777777777777777766666666777777775555555555555555666666666666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555555555556666666666666666777777776666666666666666666666665555555555555555555555556666666655555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555777777777777777766666666666666666666666666666666666666666666666666666666555555555555555555555555555555557777777755555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
55555555555555557777777777777777666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777777777777777777766666666666666666666666666666666666666666666666666666666666666666666666655555555555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666dddddddddddddddddddddddd555555555555555555555555
77777777dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd55555555
77777777dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd55555555
7777777ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd55555555
7777777deeedededeeeddeedddddeeedeeeddeedededeeedddddededededeeedeeedddddeeedededdeedeeedddddeeedddddeeedeeedeeeddddddddd55555555
7777777ddeddededdeddedddddddeeeddeddedddededdeddddddededededededdedddddddeddedededdddeddddddededddddededdedddeddddeddddd55555555
77777777deddeeeddeddeeedddddededdeddedddeeeddeddddddeeedededeedddedddddddeddededeeeddeddddddeeedddddeedddedddeddeeeddddd55555555
77777777deddededdeddddedddddededdeddededededdeddddddededededededdedddddddeddededddeddeddddddededddddededdedddeddeddddddd55555555
77777777deddededeeedeeddddddededeeedeeedededdeddddddededdeedededdeddddddeedddeedeedddeddddddededddddeeedeeeddedddddddddd55555555
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd

__sfx__
000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
01100000023032920002300262000530010205073000e205053030200004300050000030007000023000500007303000000730000000053000000004300000000530305300043000000000300000000230000000
01100000054000000005400000000440000000024000000009400000000940000000074000000005400000000e400000000e400000000c4000000009400000000e40009400074000540007400054000440002400
01100000244001a4002b4001d400264001a4002b4002b4001f4001f4001d4001d4001c4001c4001a4000000026400264052840528405294052b4052b4052d4052b40529405284052640529405264052840526405
011000001a4031d7051c7051a7051a4031d7051c7051a7051a4031d705296051a7051a4031d7051c7051a7051a4031d7051c7051a7051a4031d7051c7051a7051a4031d705296051a7051a403296051a40321705
011000001f7051d7051a7051a70500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a7051a7051a7051a7051a7051a7051a7051a705
011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a7051a7051a7051a7051a7051a7051a7051a705
010800002660526605266052660526605266052660526605266052660526605266052660526605266052660526605266052660526605266052660526605266052660526605266052660526605266052660526605
011000000c0500c05510050100550e0500e05511055130550c0500c0551305013055110501105515055130550c0500c05510050100550e0500e05511055130551705515055130551505513055110551305511055
011000001f7351f7351f7351f7351c7351c7351c7351c73524000240002400024000000000000000000000001f7351f7351f7351f7351c7351c73523725247250000500005000000000000000000000000000000
01100000286051a000186151a30018605180001861500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000185151f6051f515236051c51526605
011000000c4500c35010350104550e3500e35511455133550c3500c4551335013355114501135515375134550c3500c35510450103750e3000e47511355133551745515355133551545513455113551345511455
0110000018610246111861124611246313063124621306113c611246113061124611186211861124611306113c6212461118611306112464118611306412461118631306113c621306112461118621246110c645
0110000000000000000000000000000002966000000000001a1201a1202613026140261301a1201a13000000322600000033230332401b246272301c2001a2002923029670293503545018000000000000000000
011000003541035410354202943035420354203543035430354303542035410294102942029420294102941035410294203542035420354303543035430354203542035410354103542029420354103542035430
__music__
00 00464344
01 08090a47
00 08090a47
02 0b0c0d0e

